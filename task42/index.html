<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>会动的简历</title>
    <link rel="stylesheet" href="vendor/prism/prism.css">
    <link rel="stylesheet" href="css/defalutl.css">
    <link href="http://cdn.bootcss.com/highlight.js/8.0/styles/monokai_sublime.min.css" rel="stylesheet">  
    <script src="http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>  
    <script >hljs.initHighlightingOnLoad();</script>  
    <style id='styleTag'>
   
    </style>
</head>
<body>
    <pre id="code"></pre>
    <script src="vendor/prism/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
/*把code写到code和style标签里面去*/

function writeCode(prefix,code,fn){
    let domCode=document.querySelector('#code')
    domCode.innerHTML=prefix||''
    let n=0
    console.log("设置闹钟")
    console.log(fn)
    let id=setInterval(()=>{
        n+=1
        // code.innerHTML=result.substring(0,n)
        // code.innerHTML=code.innerHTML.replace('html','<span style="color:red">html</span>')
        console.log('开始写代码')
        domCode.innerHTML=prefix+code.substring(0,n)
        domCode.innerHTML=Prism.highlight( domCode.innerHTML, Prism.languages.css, 'css');

        styleTag.innerHTML=prefix+code.substring(0,n)
        domCode.scrollTop=domCode.scrollHeight
        if(n>=code.length){
            window.clearInterval(id)
            fn && fn.call()
        }
    },10)

}


function witeMarkdown(markdown,fn){
    let domPaper=document.querySelector('#paper>.content')
    let n=0   
    let id=setInterval(()=>{
        n+=1        
        console.log('开始写代码')
        domPaper.innerHTML=markdown.substring(0,n)   
        domPaper.scrollTop=domPaper.scrollHeight
        if(n>=markdown.length){
            window.clearInterval(id)
            fn && fn.call()
        }
    },10)

}

// const codettt = `body{color：red}`;
// const html = Prism.highlight(codettt, Prism.languages.css, 'css');
// console.log(html)

        var result= `
        /* 
        * 面试官你好，我是XXX
        * 只用文字作做我介绍太单调了
        * 我就用代码来介绍吧
        * 首先准备一些样式
        */

        *{        
            transition: all 1s;
        }

        html{font-size:16px；
            background:rgb(222,222,222)
            }
        #code{
            border:1px solid red;
            padding:16px;}

        /*我需要一点代码高亮*/
        .token.selector{
            color:#690;
        }

        .token.property{
            color:#905
        }
        .token.function{
            color: #dd4a68;
        }

        /*加点3D效果*/
        #code{
            transform:rotate(360deg)
        }


        /*不玩了，我老介绍一下我自己吧*/ 
        /*我需要一张白纸*/ 

        #code{
            position:fixed;
            left:0;
            width:50%;
            height:100%
        }
        #paper{
            position:fixed;
            right:0;
            width:50%;
            height:100%;
            background:black;
            display:flex;
            justify-content:center;
            align-items:center;
            padding:16px
        }

        #paper >.content{
            background:white;
            height:100%;
            width:100%
        }
        /*我需要在白纸上写上请看右边*/
        `
        var result2= `
        /*
        *接下来用优秀的库marked.js
        *接下来就是给HTML加样式        
        */
        `
        var result3=`
        /*
        * 这就是我的会动的简历
        * 谢谢观看
        * /
        `

        var md = `# 自我介绍

我叫 XXX
1990 年 1 月出生
XXX 学校毕业
自学前端半年
希望应聘前端开发岗位

# 技能介绍

熟悉 JavaScript CSS

# 项目介绍

1. XXX 轮播
2. XXX 简历
3. XXX 画板

# 联系方式

- QQ xxxxxxxx
- Email xxxxxxxx
- 手机 xxxxxxx
        `
        var md2=`# Marked in the browser\n\n     
           
        Rendered by **marked**        
        `


       // writeCode(result)//定闹钟：10毫秒钟之后开始写第一行代码
        // writeCode('',result,()=>{          
        //     createPaper(()=>{
        //         writeCode(result,result2,()=>{
        //             witeMarkdown(md)
        //         })
        //     })
        // })

        writeCode('',result,()=>{          
            createPaper(()=>{               
                    witeMarkdown(md,()=>{
                        writeCode(result,result2,()=>{ 
                            bianHTML()
                         })
                    })
               
            })
        })
        
        //1.定闹钟
        //2.writeCode返回
        //3.执行fn2()
        //4.闹钟事件到
        //5.写第一行代码

        function createPaper(fn){
            var paper=document.createElement('div')
            paper.id="paper"
            var content=document.createElement('pre')
            content.className="content"
            paper.appendChild(content)
            document.body.appendChild(paper)
            fn.call()
        }
        
        function bianHTML(){
            document.querySelector('#paper>.content').innerHTML =  marked(md);
        }
    
    </script>
    
</body>
</html>